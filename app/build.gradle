apply plugin: 'com.android.application'
apply plugin: 'kotlin-android'
apply plugin: 'kotlin-kapt'
apply plugin: 'findbugs'
apply plugin: 'kotlin-android-extensions'

android {
  compileSdkVersion rootProject.ext.androidCompileSdkVersion
  buildToolsVersion rootProject.ext.androidBuildToolsVersion
  defaultConfig {
    applicationId "com.leodeleon.popmovies"
    minSdkVersion rootProject.ext.androidMinSdkVersion
    targetSdkVersion rootProject.ext.androidTargetSdkVersion
    versionCode 1
    versionName "1.0"
    testInstrumentationRunner "android.support.test.runner.AndroidJUnitRunner"
    vectorDrawables.useSupportLibrary = true
  }
  signingConfigs {
    release
  }
  compileOptions {
    sourceCompatibility JavaVersion.VERSION_1_8
    targetCompatibility JavaVersion.VERSION_1_8
  }
  buildTypes {
    release {
      signingConfig signingConfigs.release
      minifyEnabled false
      proguardFiles getDefaultProguardFile('proguard-android.txt'), 'proguard-rules.pro'
    }
    buildTypes.each {
      it.buildConfigField 'String', 'MOVIE_DB_API_KEY', MovieDBApiKey
      it.buildConfigField 'String', 'GOOGLE_APIS_KEY', DeveloperConsoleApiKey
    }
  }
  configurations.all {
    resolutionStrategy.force 'com.google.code.findbugs:jsr305:2.0.1'
  }
  testOptions {
    unitTests.returnDefaultValues = true
  }
  sourceSets {
    main {
      java{
        srcDirs += 'src/main/kotlin'
      }
      res{
        srcDirs =
            [
                'src/main/res/layouts/base',
                'src/main/res/layouts/items',
                'src/main/res/layouts/views',
                'src/main/res/layouts',
                'src/main/res'
            ]
      }
    }
  }
}

//kapt {
//  generateStubs = true
//}


dependencies {
  Map<String, String> dependencies = rootProject.ext.dependencies;

  compile fileTree(dir: 'libs', include: ['*.jar'])
  androidTestCompile('com.android.support.test.espresso:espresso-core:2.2.2', {
    exclude group: 'com.android.support', module: 'support-annotations'
  })

  compile dependencies.kotlin
  testCompile dependencies.kotlin

  //support
  compile dependencies.appcompat
  compile dependencies.support
  compile dependencies.constraint
  compile dependencies.design
  compile dependencies.recyclerview
  compile dependencies.cardview
  compile dependencies.customTabs

  //firebase
  compile dependencies.firebaseCrash

  //networking

  compile dependencies.moshi
  compile dependencies.retrofit
  compile dependencies.retrofitMoshi
  compile dependencies.retrofitRxJava
  compile dependencies.rxjava
  compile dependencies.rxandroid
  compile dependencies.okhttp
  compile dependencies.okhttpLogging
  compile dependencies.stetho
  compile dependencies.glide
  //DI
  compile dependencies.timber
  compile dependencies.butterknife
  kapt dependencies.butterknifeCompiler

  compile dependencies.dagger
  compile dependencies.daggerAndroid
  compile dependencies.daggerAndroidSupport
  kapt dependencies.daggerCompiler
  kapt dependencies.daggerAndroidProcessor

  compile dependencies.lifecycle
  kapt dependencies.lifecycleCompiler

  compile dependencies.room
  compile dependencies.roomRxJava
  kapt dependencies.roomCompiler

  debugCompile dependencies.chuck
  releaseCompile dependencies.chuckNoOp

  compile dependencies.rxBindings
  compile dependencies.rxBindingsSupport
  compile dependencies.rxBindingsDesign
  compile dependencies.rxBindingsAppCompat
  compile dependencies.rxBindingsRecycler

  testCompile dependencies.mockito
  androidTestCompile dependencies.mockitoAndroid
  testCompile 'junit:junit:4.12'


  //custom views
  compile 'net.opacapp:multiline-collapsingtoolbar:1.3.1'
  compile 'com.jpardogo.materialtabstrip:library:1.1.1'
  compile 'com.beloo.widget:ChipsLayoutManager:0.3.7@aar'
  compile 'com.robertlevonyan.view:MaterialChipView:1.0.1'
  compile 'org.apmem.tools:layouts:1.10@aar'

  compile files('libs/YouTubeAndroidPlayerApi.jar')


}

apply plugin: 'com.google.gms.google-services'
apply from: "${rootDir}/config/codequality-findbugs.gradle"
apply from: "${rootDir}/config/codequality-pmd.gradle"
repositories {
  mavenCentral()
}
